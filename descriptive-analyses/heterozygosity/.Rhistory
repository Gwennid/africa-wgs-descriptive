q()
q()
q()
q()
q()
q()
149-25-48
104-24-5
q()
q()
50000/550
40*4*550
88000*1.3
25+48+75
25+48+74
q()
q()
40*4*550
40*4*550*0.3
q()
q)
q()
51089157-51095148
51089157-50765956
51089157-51136753
q()
6*4
1/14
1/24
25+48+101
q()
q()
q()
44228,76-32230
44228.76-32230
q()
q()
source("~/.active-rstudio-document", echo=TRUE)
q()
q()
q()
q()
q()
q()
q()
q()
q()
0.78/61
0.49/46
q()
q()
q()
8.5*550
16500-4675
11825/550
7837/550
16500/550
q()
q()
q()
q()
q()
q()
q()
q()
q()
q()
q()
q()
28*3
q()
q()
q()
q()
q)
q()
q()
q()
5+14+13+8+13
53*25
72*53
q()
q()
q()
50000/550
q()
q()
q(save = n)
q()
21+31+6+5+2+1
16/42
13/35
0.78/61
0.49/46
q()
q()
q()
q()
q()
q()
q()
18*3
18*3.5
18*4
72/4
72/8
18*3
54/8
54/4
q()
35217300/36272545
-35217300+36272545
177*22
q()
q()
q()
q()
q()
q()
library(magrittr)
library(tidyverse)
install.packages(tidyverse)
install.packages("tidyverse")
install.packages("tidyverse")
install.packages("tidyverse")
library(tidyverse)
install.packages("cli")
install.packages("cli")
library(tidyverse)
library(admixtools)
install.packages("admixtools")
install.packages("devtools")
library("devtools")
devtools::install_github("uqrmaie1/admixtools")
packageVersion('cli')
q()
q()
q()
q()
q()
q()
q()
47*2*3/4
q()
q()
14.3*2+11.2
q()
q()
75/6
1000/12
83/24
q()
()
q()
q()
q()
q()
q()
q()
q()
s=1130.034
s*1.1
q()
q()
q()
q()
q()
q()
q()
q()
q()
q()
q()
q()
q()
q()
q()
15*30
install.packages("vioplot")
data("iris")
library(vioplot)
boxplot(iris$Sepal.Length[iris$Species=="setosa"], iris$Sepal.Length[iris$Species=="versicolor"], iris$Sepal.Length[iris$Species=="virginica"], names=c("setosa", "versicolor", "virginica"))
x=boxplot(iris$Sepal.Length[iris$Species=="setosa"], iris$Sepal.Length[iris$Species=="versicolor"], iris$Sepal.Length[iris$Species=="virginica"], names=c("setosa", "versicolor", "virginica"))
x
q()
q()
q()
q()
12000*30
128/20
256/20
q()
5000*48
q()
5000*48
5000*8
5000*16
i=25
(i-1)*5000+1
(i)*5000
length(c("1","2","3","4","5","6","7","8","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32"))
length(c("33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56"))
q()
q()
q()
1/138
77*2
1/154
76*2+1
1/154*100
q()
3/4
10/14
8/11
9/12
8/12
q()
q()
84*2.5
q()
q()
q()
q()
q()
q()
q()
38/3
49/3
43.3/3
440*0.15
q()
q()
q()
q)
q()
q()
q()
q()
q()
q()
40*500
q()
q()
8900*1.12
5000*48
q()
q()
q()
q()
q()
q()
q()
3300*0.05
setwd("/home/gwennabreton/Documents/PhD/Projects/Project2_Pygmies_KhoeSan_project/sequence_processing/scripts/analyses/ROH/")
library(RColorBrewer)
col_RHG_RHGn_KS <- c(brewer.pal(6,"Blues")[2:6],brewer.pal(5,"Greens")[2:5],brewer.pal(6,"Reds")[2:6])
col_comp <- c(col_RHG_RHGn_KS[1:2],col_RHG_RHGn_KS[10:11],brewer.pal(9,"Purples")[c(2:3,3:9)],brewer.pal(9,"Oranges")[2:9],
brewer.pal(4,"PuRd")[2:4],brewer.pal(9,"YlOrRd")[2:4],"black",brewer.pal(6,"Greys")[2:6])
col_all <- c(col_RHG_RHGn_KS,col_comp)
col_africa <- col_all[1:42]
pch_RHG_RHGn_KS <- c(21:25,21:24,21:25)
pch_comp <- c(0:5,5,7:14,0:1,5,6,4:11,3,13:14,0:2) #This list has been modified to accommodate for unhappy doubletons in colors and shapes.
pch_all <- c(pch_RHG_RHGn_KS,pch_comp)
pch_africa <- pch_all[1:42]
###
### The colors and PCH were used to make (manually) the following two files: info_ind_for_plotting.txt and info_pop_for_plotting.txt
order <- read.table(file="/Users/gwennabreton/Documents/Previous_work/PhD_work/P2_RHG_KS/writing/ms/ongoing/Figures/Figure_sampling_locations/poporder_46pop_20230831.txt", sep="\t", quote="\"")
info_pop <- read.table(file="../info_pop_for_plotting.txt", sep="\t", quote="\"", comment.char="",header=TRUE)
info_pop$POPNAME == order$V1
###
### The colors and PCH were used to make (manually) the following two files: info_ind_for_plotting.txt and info_pop_for_plotting.txt
order <- read.table(file="/Users/gwennabreton/Documents/Previous_work/PhD_work/P2_RHG_KS/writing/ms/ongoing/Figures/Figure_sampling_locations/poporder_46pop_20230831.txt", sep="\t", quote="\"")
getwd()
info_pop <- read.table(file="/Users/gwennabreton/Documents/Previous_work/PhD_work/P2_RHG_KS/writing/ms/ongoing/Figures/info_pop_for_plotting.txt", sep="\t", quote="\"", comment.char="",header=TRUE)
info_pop$POPNAME == order$V1
info_pop$POPNAMEALT == order$V2 #these are not matching for three items. (GuiGana, Xhosa, Sotho) I'm not changing them as I'm not using these names (I think). But should I need to use these names, I'd need to change it.
q()
prcomp
q()
q()
q()
q()
q()
2400+1300
2400+1600
2400+2500
q()
q()
q()
q()
q()
q()
10000*25
q()
q()
q()
q()
q()
q()
q()
q()
q()
q()
q()
2/14
q()
30*160
60*60
30*114
30*115
q()
q()
q()
30*20
50*20
4*4*4
q()
q()
q()
q()
q()
q()
q()
q()
q()
q()
44980300-44967189
42/4
50/3
50*22
q()
90*25
2250/60
50/3
17+17+16
90*17
90*17/60
q()
q()
q()
q()
q()
q()
q()
q()
q()
q()
q()
q()
q()
q()
q()
q()
q()
q()
25+49
q()
q()
q()
q()
50*246
27*50
37*50
q)
q()
q()
q()
q()
q()
41186-34430
453/3
8*22
q()
q()
q()
q()
31+29+15
4500*25
4500*30
q()
q()
q()
# Code
data <- read.table(file="/Users/gwennabreton/Documents/Previous_work/PhD_work/P2_RHG_KS/africa-wgs-abc/results/heterozygosity/allchr_allpop_Het_obs_exp_bialsites.txt",header=TRUE)
info <- read.table(file="/Users/gwennabreton/Documents/Previous_work/PhD_work/P2_RHG_KS/africa-wgs-abc/descriptive-analyses/45pop_info.txt", header = TRUE)
dim(data)
names(daa)
names(data)
unique(data$POPNAME)
##Remove the populations for which I have no information (Because the sample size was 1)
info_42 <- info[info$POPNAMEalt != "Zulu" & info$POPNAMEalt != "Somali" & info$POPNAMEalt != "Kongo",]
boxplot(data$H_E_UNBIASED_ALLSITES ~ data$POP) #Unbiased estimate, over all sites; range: 0.0006-0.0012
boxplot(data$H_E_UNBIASED_ALLSITES ~ data$POPNAME) #Unbiased estimate, over all sites; range: 0.0006-0.0012
42*22
# Remove the "noHGDP" populations
data_42 <- data[1:924,]
unique(data_42$POPNAME)
boxplot(data$H_E_UNBIASED_VARSITES ~ data$POPNAME) #Unbiased estimate, over variable sites; range: 0.3-0.55
boxplot(data$H_E_UNBIASED_ALLSITES ~ data$POPNAME) #Unbiased estimate, over all sites; range: 0.0006-0.0012
boxplot(data$H_E_UNBIASED_VARSITES ~ data$POPNAME) #Unbiased estimate, over variable sites; range: 0.3-0.55
boxplot(data$H_E_ALLSITES ~ data$POPNAME) #Uncorrected estimate, all sites; range: similar to unbiased
#Plot H_E_UNBIASED_ALLSITES
new_order_unbiased_all <- with(data, reorder(data$POPNAME, data$H_E_UNBIASED_ALLSITES, median, na.rm=T))
par(mar=c(7.5, 4, 4, 2) + 0.1)
boxplot(data$H_E_UNBIASED_ALLSITES ~ new_order_unbiased_all, ylab = "Expected unbiased heterozygosity over all sites", xlab = "", las = 3)
##Use better population names and color by pop
a <- match(levels(new_order_unbiased_all), info_42$POPNAMEalt)
dim(a)
info_42a <- info_42[a,]
info_42a
# Code
data42 <- read.table(file="/Users/gwennabreton/Documents/Previous_work/PhD_work/P2_RHG_KS/africa-wgs-abc/results/heterozygosity/allchr_42pop_Het_obs_exp_bialsites.txt",header=TRUE)
# Code
data42 <- read.table(file="/Users/gwennabreton/Documents/Previous_work/PhD_work/P2_RHG_KS/africa-wgs-abc/results/heterozygosity/allchr_42pop_Het_obs_exp_bialsites.txt",header=TRUE)
info <- read.table(file="/Users/gwennabreton/Documents/Previous_work/PhD_work/P2_RHG_KS/africa-wgs-abc/descriptive-analyses/45pop_info.txt", header = TRUE)
##Remove the populations for which I have no information (Because the sample size was 1)
info_42 <- info[info$POPNAMEalt != "Zulu" & info$POPNAMEalt != "Somali" & info$POPNAMEalt != "Kongo",]
boxplot(data$H_E_UNBIASED_ALLSITES ~ data$POPNAME) #Unbiased estimate, over all sites; range: 0.0006-0.0012
dim(data42)
names(data42)
boxplot(data$H_E_UNBIASED_ALLSITES ~ data$POPNAME) #Unbiased estimate, over all sites; range: 0.0006-0.0012
boxplot(data42$H_E_UNBIASED_ALLSITES ~ data42$POPNAME) #Unbiased estimate, over all sites; range: 0.0006-0.0012
boxplot(data42$H_E_UNBIASED_VARSITES ~ data42$POPNAME) #Unbiased estimate, over variable sites; range: 0.3-0.55
boxplot(data42$H_E_ALLSITES ~ data42$POPNAME) #Uncorrected estimate, all sites; range: similar to unbiased
#Plot H_E_UNBIASED_ALLSITES
new_order_unbiased_all <- with(data42, reorder(data42$POPNAME, data42$H_E_UNBIASED_ALLSITES, median, na.rm=T))
par(mar=c(7.5, 4, 4, 2) + 0.1)
boxplot(data42$H_E_UNBIASED_ALLSITES ~ new_order_unbiased_all, ylab = "Expected unbiased heterozygosity over all sites", xlab = "", las = 3)
##Use better population names and color by pop
a <- match(levels(new_order_unbiased_all), info_42$POPNAMEalt)
info_42a <- info_42[a,]
par(mar=c(7.5, 4, 2, 2) + 0.1)
boxplot(data42$H_E_UNBIASED_ALLSITES ~ new_order_unbiased_all,
ylab = "Expected unbiased heterozygosity over all sites", xlab = "", las = 3,
col = info_42a$COLalt, names = info_42a$POPNAME)
#Plot H_E_UNBIASED_VARSITES
new_order_unbiased_var <- with(data42, reorder(data42$POPNAME, data42$H_E_UNBIASED_VARSITES, median, na.rm=T))
par(mar=c(7.5, 4, 4, 2) + 0.1)
boxplot(data42$H_E_UNBIASED_VARSITES ~ new_order_unbiased_var, ylab = "Expected unbiased heterozygosity over variable sites", xlab = "", las = 3)
##Use better population names and color by pop
b <- match(levels(new_order_unbiased_var), info_42$POPNAMEalt)
info_42b <- info_42[b,]
par(mar=c(7.5, 4, 2, 2) + 0.1)
boxplot(data42$H_E_UNBIASED_VARSITES ~ new_order_unbiased_var,
ylab = "Expected unbiased heterozygosity over variable sites", xlab = "", las = 3,
col = info_42b$COLalt, names = info_42b$POPNAME)
head(info_42)
getwd()
setwd("/Users/gwennabreton/Documents/Previous_work/PhD_work/P2_RHG_KS/africa-wgs-abc/descriptive-analyses/heterozygosity/")
chrX <- read.table(file="../../results/chrX_PARremoved_allpop_Het_exp_bialsites.txt",header=TRUE)
write.table(file="X_PARremoved_aut_ratio_perpop_51pop.txt", t(c("POPNAME","RATIO","AVG_EXPECTED_HET_AUTOSOMES","RATIO_UNBIASED","AVG_EXPECTED_HET_AUTOSOMES_UNBIASED")), col.names = FALSE,row.names = FALSE)
chrX <- read.table(file="../../results/heterozygosity/chrX_allpop_Het_exp_bialsites.txt",header=TRUE)
autosomes <- read.table(file="../../results/heterozygosity/allpop_avg_het_1-22",header=TRUE)
for (POPNAME in c("Baka","Nzime","BaKola","Ngumba","AkaMbati","BaKiga","BaTwa","Nsua","BaKonjo","Karretjiepeople","GuiandGana","Juhoansi","Nama","Xun","BantuHerero",
"BantuKenya","BantuTswana","Biaka","Dinka","Esan","Gambian","Igbo","Juhoansi_comp","Khomani","Lemande","Luhya","Luo","Mandenka","Maasai","Mbuti",
"Mende","Mozabite","Saharawi","Yoruba","DaiChinese","Karitiana","Papuan","French","CEU","Coloured","SothoSpeakers","XhosaSpeakers","Juhoansi_comp_noHGDP",
"Dinka_noHGDP","French_noHGDP","Papuan_noHGDP","Yoruba_noHGDP","Mbuti_noHGDP","Mandenka_noHGDP","Karitiana_noHGDP","DaiChinese_noHGDP")) {
ratio <- chrX$H_E_ALLSITES[chrX$POPNAME==POPNAME]/autosomes$AVG_EXPECTED_HET[autosomes$POPNAME==POPNAME]
het_aut <- autosomes$AVG_EXPECTED_HET[autosomes$POPNAME==POPNAME]
ratio_unbiased <- chrX$H_E_UNBIASED_ALLSITES[chrX$POPNAME==POPNAME]/autosomes$AVG_UNBIASED_EXPECTED_HET[autosomes$POPNAME==POPNAME]
het_aut_unbiased <- autosomes$AVG_UNBIASED_EXPECTED_HET[autosomes$POPNAME==POPNAME]
write.table(file="X_PARremoved_aut_ratio_perpop_allpop.txt", append=TRUE, t(c(POPNAME,ratio,het_aut,ratio_unbiased,het_aut_unbiased)), col.names = FALSE,row.names = FALSE)
}
for (POPNAME in c("Baka","Nzime","BaKola","Ngumba","AkaMbati","BaKiga","BaTwa","Nsua","BaKonjo","Karretjiepeople","GuiandGana","Juhoansi","Nama","Xun","BantuHerero",
"BantuKenya","BantuTswana","Biaka","Dinka","Esan","Gambian","Igbo","Juhoansi_comp","Khomani","Lemande","Luhya","Luo","Mandenka","Maasai","Mbuti",
"Mende","Mozabite","Saharawi","Yoruba","DaiChinese","Karitiana","Papuan","French","CEU","Coloured","SothoSpeakers","XhosaSpeakers","Juhoansi_comp_noHGDP",
"Dinka_noHGDP","French_noHGDP","Papuan_noHGDP","Yoruba_noHGDP","Mbuti_noHGDP","Mandenka_noHGDP","Karitiana_noHGDP","DaiChinese_noHGDP")) {
ratio <- chrX$H_E_ALLSITES[chrX$POPNAME==POPNAME]/autosomes$AVG_EXPECTED_HET[autosomes$POPNAME==POPNAME]
het_aut <- autosomes$AVG_EXPECTED_HET[autosomes$POPNAME==POPNAME]
ratio_unbiased <- chrX$H_E_UNBIASED_ALLSITES[chrX$POPNAME==POPNAME]/autosomes$AVG_UNBIASED_EXPECTED_HET[autosomes$POPNAME==POPNAME]
het_aut_unbiased <- autosomes$AVG_UNBIASED_EXPECTED_HET[autosomes$POPNAME==POPNAME]
write.table(file="X_PARremoved_aut_ratio_perpop_51pop.txt", append=TRUE, t(c(POPNAME,ratio,het_aut,ratio_unbiased,het_aut_unbiased)), col.names = FALSE,row.names = FALSE)
}
write.table(file="../../results/heterozygosity/X_PARremoved_aut_ratio_perpop_51pop.txt", append=TRUE, t(c(POPNAME,ratio,het_aut,ratio_unbiased,het_aut_unbiased)), col.names = FALSE,row.names = FALSE)
for (POPNAME in c("Baka","Nzime","BaKola","Ngumba","AkaMbati","BaKiga","BaTwa","Nsua","BaKonjo","Karretjiepeople","GuiandGana","Juhoansi","Nama","Xun","BantuHerero",
"BantuKenya","BantuTswana","Biaka","Dinka","Esan","Gambian","Igbo","Juhoansi_comp","Khomani","Lemande","Luhya","Luo","Mandenka","Maasai","Mbuti",
"Mende","Mozabite","Saharawi","Yoruba","DaiChinese","Karitiana","Papuan","French","CEU","Coloured","SothoSpeakers","XhosaSpeakers","Juhoansi_comp_noHGDP",
"Dinka_noHGDP","French_noHGDP","Papuan_noHGDP","Yoruba_noHGDP","Mbuti_noHGDP","Mandenka_noHGDP","Karitiana_noHGDP","DaiChinese_noHGDP")) {
ratio <- chrX$H_E_ALLSITES[chrX$POPNAME==POPNAME]/autosomes$AVG_EXPECTED_HET[autosomes$POPNAME==POPNAME]
het_aut <- autosomes$AVG_EXPECTED_HET[autosomes$POPNAME==POPNAME]
ratio_unbiased <- chrX$H_E_UNBIASED_ALLSITES[chrX$POPNAME==POPNAME]/autosomes$AVG_UNBIASED_EXPECTED_HET[autosomes$POPNAME==POPNAME]
het_aut_unbiased <- autosomes$AVG_UNBIASED_EXPECTED_HET[autosomes$POPNAME==POPNAME]
write.table(file="../../results/heterozygosity/X_PARremoved_aut_ratio_perpop_51pop.txt", append=TRUE, t(c(POPNAME,ratio,het_aut,ratio_unbiased,het_aut_unbiased)), col.names = FALSE,row.names = FALSE)
}
write.table(file="../../results/heterozygosity/X_PARremoved_aut_ratio_perpop_51pop.txt", t(c("POPNAME","RATIO","AVG_EXPECTED_HET_AUTOSOMES","RATIO_UNBIASED","AVG_EXPECTED_HET_AUTOSOMES_UNBIASED")), col.names = FALSE,row.names = FALSE)
for (POPNAME in c("Baka","Nzime","BaKola","Ngumba","AkaMbati","BaKiga","BaTwa","Nsua","BaKonjo","Karretjiepeople","GuiandGana","Juhoansi","Nama","Xun","BantuHerero",
"BantuKenya","BantuTswana","Biaka","Dinka","Esan","Gambian","Igbo","Juhoansi_comp","Khomani","Lemande","Luhya","Luo","Mandenka","Maasai","Mbuti",
"Mende","Mozabite","Saharawi","Yoruba","DaiChinese","Karitiana","Papuan","French","CEU","Coloured","SothoSpeakers","XhosaSpeakers","Juhoansi_comp_noHGDP",
"Dinka_noHGDP","French_noHGDP","Papuan_noHGDP","Yoruba_noHGDP","Mbuti_noHGDP","Mandenka_noHGDP","Karitiana_noHGDP","DaiChinese_noHGDP")) {
ratio <- chrX$H_E_ALLSITES[chrX$POPNAME==POPNAME]/autosomes$AVG_EXPECTED_HET[autosomes$POPNAME==POPNAME]
het_aut <- autosomes$AVG_EXPECTED_HET[autosomes$POPNAME==POPNAME]
ratio_unbiased <- chrX$H_E_UNBIASED_ALLSITES[chrX$POPNAME==POPNAME]/autosomes$AVG_UNBIASED_EXPECTED_HET[autosomes$POPNAME==POPNAME]
het_aut_unbiased <- autosomes$AVG_UNBIASED_EXPECTED_HET[autosomes$POPNAME==POPNAME]
write.table(file="../../results/heterozygosity/X_PARremoved_aut_ratio_perpop_51pop.txt", append=TRUE, t(c(POPNAME,ratio,het_aut,ratio_unbiased,het_aut_unbiased)), col.names = FALSE,row.names = FALSE)
}
ratio_unbiased
names(chrX)
setwd("/Users/gwennabreton/Documents/Previous_work/PhD_work/P2_RHG_KS/africa-wgs-abc/descriptive-analyses/heterozygosity/")
chrX <- read.table(file="../../results/heterozygosity/chrX_allpop_Het_exp_bialsites.txt",header=TRUE)
autosomes <- read.table(file="../../results/heterozygosity/allpop_avg_het_1-22",header=TRUE)
write.table(file="../../results/heterozygosity/X_PARremoved_aut_ratio_perpop_51pop.txt", t(c("POPNAME","RATIO","AVG_EXPECTED_HET_AUTOSOMES","RATIO_UNBIASED","AVG_EXPECTED_HET_AUTOSOMES_UNBIASED")), col.names = FALSE,row.names = FALSE)
for (POPNAME in c("Baka","Nzime","BaKola","Ngumba","AkaMbati","BaKiga","BaTwa","Nsua","BaKonjo","Karretjiepeople","GuiandGana","Juhoansi","Nama","Xun","BantuHerero",
"BantuKenya","BantuTswana","Biaka","Dinka","Esan","Gambian","Igbo","Juhoansi_comp","Khomani","Lemande","Luhya","Luo","Mandenka","Maasai","Mbuti",
"Mende","Mozabite","Saharawi","Yoruba","DaiChinese","Karitiana","Papuan","French","CEU","Coloured","SothoSpeakers","XhosaSpeakers","Juhoansi_comp_noHGDP",
"Dinka_noHGDP","French_noHGDP","Papuan_noHGDP","Yoruba_noHGDP","Mbuti_noHGDP","Mandenka_noHGDP","Karitiana_noHGDP","DaiChinese_noHGDP")) {
ratio <- chrX$H_E_ALLSITES[chrX$POPNAME==POPNAME]/autosomes$AVG_EXPECTED_HET[autosomes$POPNAME==POPNAME]
het_aut <- autosomes$AVG_EXPECTED_HET[autosomes$POPNAME==POPNAME]
ratio_unbiased <- chrX$H_E_UNBIASED_ALLSITES[chrX$POPNAME==POPNAME]/autosomes$AVG_UNBIASED_EXPECTED_HET[autosomes$POPNAME==POPNAME]
het_aut_unbiased <- autosomes$AVG_UNBIASED_EXPECTED_HET[autosomes$POPNAME==POPNAME]
write.table(file="../../results/heterozygosity/X_PARremoved_aut_ratio_perpop_51pop.txt", append=TRUE, t(c(POPNAME,ratio,het_aut,ratio_unbiased,het_aut_unbiased)), col.names = FALSE,row.names = FALSE)
}
q()
